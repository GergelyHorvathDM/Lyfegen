aW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnOwppbXBvcnQgeyBCb3RJY29uLCBTZW5kSWNvbiwgUGFwZXJjbGlwSWNvbiwgRmlsZUljb24sIFhJY29uLCBMb2FkZXJJY29uLCBVc2VySWNvbiB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7CmltcG9ydCBSZWFjdE1hcmtkb3duIGZyb20gJ3JlYWN0LW1hcmtkb3duJzsKaW1wb3J0IHJlbWFya0dmcyBmcm9tICdyZW1hcmstZ2ZtJzsKCmNvbnN0IENoYXQgPSAoeyBhcGlLZXkgfSkgPT4gewogIGNvbnN0IFttZXNzYWdlcywgc2V0TWVzc2FnZXNdID0gdXNlU3RhdGUoW10pOwogIGNvbnN0IFtpbnB1dCwgc2V0SW5wdXRdID0gdXNlU3RhdGUoJycpOwogIGNvbnN0IFtzdGF0dXMsIHNldFN0YXR1c10gPSB1c2VTdGF0ZSgnaWRsZScpOyAvLyBpZGxlLCB0aGlua2luZywgc3RyZWFtaW5nCiAgY29uc3QgW3Nlc3Npb25JZCwgc2V0U2Vzc2lvbklkXSA9IHVzZVN0YXRlKG51bGwpOwogIGNvbnN0IFtmaWxlLCBzZXRGaWxlXSA9IHVzZVN0YXRlKG51bGwpOwogIGNvbnN0IFtmaWxlTmFtZSwgc2V0RmlsZU5hbWVdID0gdXNlU3RhdGUoJycpOwogIGNvbnN0IG1lc3NhZ2VzRW5kUmVmID0gdXNlUmVmKG51bGwpOwogIGNvbnN0IGZpbGVJbnB1dFJlZiA9IHVzZVJlZihudWxsKTsKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIC8vIEdlbmVyYXRlIGEgdW5pcXVlIHNlc3Npb24gSUQgd2hlbiB0aGUgY29tcG9uZW50IG1vdW50cwogICAgc2V0U2Vzc2lvbklkKGNyeXB0by5yYW5kb21VVUlEKCkpOwogICAgc2V0TWVzc2FnZXMoWwogICAgICAgIHsKICAgICAgICAgICAgc2VuZGVyOiAnYm90JywKICAgICAgICAgICAgdGV4dDogIkhlbGxvISBJJ20gdGhlIEx5ZmVnZW4gRG9jdW1lbnQgSW50ZWxsaWdlbmNlIGFnZW50LiBZb3UgY2FuIGFzayBtZSBxdWVzdGlvbnMgYWJvdXQgdGhlIGRvY3VtZW50cyBpbiBteSBrbm93bGVkZ2UgYmFzZSwgb3IgdXBsb2FkIGEgUERGLCBET0NYLCBvciBUWFQgZmlsZSB0byBhc2sgcXVlc3Rpb25zIGFib3V0IGEgc3BlY2lmaWMgZG9jdW1lbnQuIgogICAgICAgIH0KICAgIF0pOwogIH0sIFtdKTsKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIC8vIEF1dG8tc2Nyb2xsIHRvIHRoZSBib3R0b20KICAgIG1lc3NhZ2VzRW5kUmVmLmN1cnJlbnQ/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOwogIH0sIFttZXNzYWdlcywgc3RhdHVzXSk7CgogIGNvbnN0IGhhbmRsZUZpbGVDaGFuZ2UgPSAoZXZlbnQpID0+IHsKICAgIGNvbnN0IHNlbGVjdGVkRmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTsKICAgIGlmIChzZWxlY3RlZEZpbGUpIHsKICAgICAgc2V0RmlsZShzZWxlY3RlZEZpbGUpOwogICAgICBzZXRGaWxlTmFtZShzZWxlY3RlZEZpbGUubmFtZSk7CiAgICB9CiAgfTsKCiAgY29uc3QgcmVtb3ZlRmlsZSA9ICgpID0+IHsKICAgIHNldEZpbGUobnVsbCk7CiAgICBzZXRGaWxlTmFtZSgnJyk7CiAgICBmaWxlSW5wdXRSZWYuaW5wdXQ/LmN1cnJlbnQudmFsdWUgPSBudWxsOyAvLyBSZXNldCBmaWxlIGlucHV0CiAgfQoKICBjb25zdCBoYW5kbGVTZW5kTWVzc2FnZSA9IGFzeW5jIChlKSA9PiB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBpZiAoIWlucHV0LnRyaW0oKSAmJiAhZmlsZSkgcmV0dXJuOwoKICAgIGNvbnN0IHVzZXJNZXNzYWdlID0geyBzZW5kZXI6ICd1c2VyJywgdGV4dDogaW5wdXQgfTsKICAgIHNldE1lc3NhZ2VzKHByZXYgPT4gWy4uLnByZXYsIHVzZXJNZXNzYWdlXSk7CiAgICBzZXRJbnB1dCgnJyk7CiAgICBzZXRTdGF0dXMoJ3RoaW5raW5nJyk7CgogICAgY29uc3QgZW5kcG9pbnQgPSBmaWxlID8gJy92MS9hZ2VudC9hZC1ob2MtY2hhdCcgOiAnL3YxL2FnZW50L3F1ZXJ5LXN0cmVhbSc7CiAgICBjb25zdCBmdWxsVXJsID0gYCR7ZW5kcG9pbnR9P2FwaV9rZXk9JHthcGlLZXl9YDsKCiAgICBsZXQgYm9keTsKICAgIGNvbnN0IGhlYWRlcnMgPSB7fTsKCiAgICBpZiAoZmlsZSkgewogICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdxdWVzdGlvbicsIGlucHV0KTsKICAgICAgICBib2R5ID0gZm9ybURhdGE7CiAgICB9IGVsc2UgewogICAgICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nOwogICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7IHNlc3Npb25faWQ6IHNlc3Npb25JZCwgcXVlcnk6IGlucHV0IH0pOwogICAgfQogICAgCiAgICBzZXRGaWxlKG51bGwpOwogICAgc2V0RmlsZU5hbWUoJycpOwogICAgaWYoZmlsZUlucHV0UmVmLmN1cnJlbnQpIHsKICAgICAgICBmaWxlSW5wdXRSZWYuaW5wdXQ/LmN1cnJlbnQudmFsdWUgPSBudWxsOwogICAgfQoKCiAgICB0cnkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZ1bGxVcmwsIHsKICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICBoZWFkZXJzLAogICAgICAgIGJvZHksCiAgICAgIH0pOwoKICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JEYXRhLmRldGFpbCB8fCBgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTsKICAgICAgfQoKICAgICAgc2V0U3RhdHVzKCdzdHJlYW1pbmcnKTsKICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgeyBzZW5kZXI6ICdib3QnLCB0ZXh0OiAnJywgc291cmNlczogW10gfV0pOwogICAgICAKICAgICAgY29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKTsKICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpOwogICAgICAgIGlmIChkb25lKSBicmVhazsKCiAgICAgICAgY29uc3QgY2h1bmsgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7CiAgICAgICAgY29uc3QgbGluZXMgPSBjaHVuay5zcGxpdCgnXG5cbicpLmZpbHRlcihsaW5lID0+IGxpbmUuc3RhcnRzV2l0aCgnZGF0YTonKSk7CgogICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykgewogICAgICAgICAgICBjb25zdCBqc29uU3RyID0gbGluZS5zdWJzdHJpbmcoNSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShqc29uU3RyKTsKCiAgICAgICAgICAgICAgICBpZiAoZGF0YS50eXBlID09PSAnc3RhdHVzJykgewogICAgICAgICAgICAgICAgICAgIHNldFN0YXR1cyhkYXRhLmNvbnRlbnQpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICdmaW5hbF9yZXNwb25zZScpIHsKICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3TWVzc2FnZXMgPSBbLi4ucHJldl07CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RNZXNzYWdlID0gbmV3TWVzc2FnZXNbbmV3TWVzc2FnZXMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0TWVzc2FnZS5zZW5kZXIgPT09ICdib3QnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0TWVzc2FnZS50ZXh0ID0gKGxhc3RNZXNzYWdlLnRleHQgfHwgJycpICsgZGF0YS5jb250ZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc291cmNlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RNZXNzYWdlLnNvdXJjZXMgPSBkYXRhLnNvdXJjZXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld01lc3NhZ2VzOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIHN0cmVhbWluZyBkYXRhOicsIGUsICdSZWNlaXZlZCBjaHVuazoJLCBqc29uU3RyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY29uc29sZS5lcnJvcignRmV0Y2ggZXJyb3I6JywgZXJyb3IpOwogICAgICBzZXRNZXNzYWdlcyhwcmV2ID0+IGBbLi4ucHJldiwgeyBzZW5kZXI6ICdib3QnLCB0ZXh0OiBgQW4gZXJyb3Igb2NjdXJyZWQ6ICR7ZXJyb3IubWVzc2FnZX1gIH1dKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHNldFN0YXR1cygnaWRsZScpOwogICAgfQogIH07CiAgCiAgcmV0dXJuICgKICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGZsZXgtY29sIGgtc2NyZWVuIGJnLWdyYXktOTAwIHRleHQtZ3JheS0xMDAgZm9udC1zYW5zIj4KICAgICAgey8qIEhlYWRlciAqL30KICAgICAgPGhlYWRlciBjbGFzc05hbWU9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBwLTQgYm9yZGVyLWIgYm9yZGVyLWdyYXktNzAwLzUwIHNoYWRvdy1sZyBiZy1ncmF5LTgwMC83MCBiYWNrZHJvcC1ibHVyLW1kIHotaTAiPgogICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTQiPgogICAgICAgICAgPGltZyBzcmM9Ii9seWZlZ2VuaGVhbHRoX2xvZ28uanBlZyIgYWx0PSJMeWZlZ2VuIExvZ28iIGNsYXNzTmFtZT0iaC0xMCB3LTEwIHJvdW5kZWQtZnVsbCBib3JkZXItMiBib3JkZXItaW5kaWdvLTUwMC81MCIvPgogICAgICAgICAgPGgxIGNsYXNzTmFtZT0idGV4dC14bCBmb250LWJvbGQgdGV4dC10cmFuc3BhcmVudCBiZy1jbGlwLXRleHQgYmctZ3JhZGllbnQtdG8tciBmcm9tLWluZGlnby00MDAgdG8tcHVycGxlLTQwMCI+CiAgICAgICAgICAgIEx5ZmVnZW4gRG9jdW1lbnQgSW50ZWxsaWdlbmNlCiAgICAgICAgICA8L2gxPgogICAgICAgIDwvZGl2PgogICAgICA8L2hlYWRlcj4KCiAgICAgIHsvKiBDaGF0IEFyZWEgKi99CiAgICAgIDxtYWluIGNsYXNzTmFtZT0iZmxleC0xIG92ZXJmbG93LXkgYXV0byBwLTYgc3BhY2UteS02Ij4KICAgICAgICB7bWVzc2FnZXMubWFwKChtc2csIGluZGV4KSA9PiAoCiAgICAgICAgICA8ZGl2CiAgICAgICAgICAgIGtleT17aW5kZXh9CiAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggaXRlbXMtZW5kIGdhcC0zICR7bXNnLnNlbmRlciA9PT0gJ3VzZXInID8gJ2p1c3RpZnktZW5kJyA6ICdqdXN0aWZ5LXN0YXJ0J31gfQogICAgICAgICAgPgogICAgICAgICAgICB7bXNnLnNlbmRlciA9PT0gJ2JvdCcgJiYgKAogICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4LXNocmluay0wIHctOCBoLTggcm91bmRlZC1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGJnLWdyYXktNzAwIHNoYWRvdy1tZCI+CiAgICAgICAgICAgICAgICA8Qm90SWNvbiBjbGFzc05hbWU9ImgtNSB3LTUiIC8+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICkofQogICAgICAgICAgICAKICAgICAgICAgICAgPGRpdgogICAgICAgICAgICAgIGNsYXNzTmFtZT17YHA0IHJvdW5kZWQtMnhsIG1heC13LXhsIGxnOm1heC13LTJ4bCB4bDptYXgtdy0zeGwgc2hhZG93LWxnICR7CiAgICAgICAgICAgICAgICBtc2cuc2VuZGVyID09PSAndXNlcicKICAgICAgICAgICAgICAgICAgPyAnYmctaW5kaWdvLTYwMCByb3VuZGVkLWJyLWxnJwogICAgICAgICAgICAgICAgICA6ICdiZy1ncmF5LTcwMCByb3VuZGVkLWJsLWxnJwogICAgICAgICAgICAgIH1gfQogICAgICAgICAgICA+CiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InByb3NlIHByb3NlLXNtIHByb3NlLWludmVydCBtYXgtdy1ub25lIHByb3NlLXA6dGV4dC1ncmF5LTIwMCBwcm9zZS1hOnRleHQtaW5kaWdvLTMwMCBob3Zlcjpwcm9zZS1hOnRleHQtaW5kaWdvLTIwMCI+CiAgICAgICAgICAgICAgICA8UmVhY3RNYXJrZG93biByZW1hcmtQbHVnaW5zPVtyZW1hcmtHZm1dfT57bXNnLnRleHR9PC9SZWFjdE1hcmtkb3duPgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgIHttc2cuc291cmNlcyAmJiBtc2cuc291cmNlcy5sZW5ndGggPiAwICYmICgKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJtdC00IHB0LTMgYm9yZGVyLXQgYm9yZGVyLWdyYXktNjAwLzUwIj4KICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT0idGV4dC14cyBmb250LWJvbGQgdGV4dC1ncmF5LTQwMCBtYi0yIj5Tb3VyY2VzOjwvaDQ+CiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGZsZXgtd3JhcCBnYXAtMiI+CiAgICAgICAgICAgICAgICAgICAge21zZy5zb3VyY2VzLm1hcCgoc291cmNlLCBpKSA9PiAoCiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGtleT17aX0gY2xhc3NOYW1lPSJiZy1ncmF5LTgwMC82MCB0ZXh0LXhzIHRleHQtZ3JheS0zMDAgcm91bmRlZC1mdWxsIHB4LTMgcHktMSB0cnVuY2F0ZSIgdGl0bGU9e3NvdXJjZS5wYXRofT4KICAgICAgICAgICAgICAgICAgICAgICAge3NvdXJjZS5wYXRoLnNwbGl0KC9bXFwvXS8pLnBvcCgpfQogICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgKSl9CiAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAge21zZy5zZW5kZXIgPT09ICd1c2VyJyAmJiAoCiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXgtc2hyaW5rLTAgdy04IGgtOCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgYmctaW5kaWdvLTYwMCBzaGFkb3ctbWQiPgogICAgICAgICAgICAgICAgPFVzZXJJY29uIGNsYXNzTmFtZT0iaC01IHctNSIgLz4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgKX0KICAgICAgICAgIDwvZGl2PgogICAgICAgICkpfQogICAgICAgIHtzdGF0dXMgIT09ICdpZGxlJyAmJiAoCiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1lbmQgZ2FwLTMganVzdGlmeS1zdGFydCI+CiAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleC1zaHJpbmstMCB3LTggaC04IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1ncmF5LTcwMCBzaGFkb3ctbWQiPgogICAgICAgICAgICAgICAgPEJvdEljb24gY2xhc3NOYW1lPSJoLTUgd-LTUiIC8+CiAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJwLTQgcm91bmRlZC0yeGwgbWF4LXctc20gYmctZ3JheS03MDAgcm91bmRlZC1ibC1sZyBzaGFkb3ctbGYgZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0zIj4KICAgICAgICAgICAgPExvYWRlckljb24gY2xhc3NOYW1lPSJoLTUgdy01IGFuaW1hdGUtc3BpbiB0ZXh0LWluZGlnby00MDAiIC8+CiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1zbSB0ZXh0LWdyYXktMzAwIj57c3RhdHVzID09PSAndGhpbmtpbmcnID8gJ1RoaW5raW5nLi4uJyA6IHN0YXR1c308L3A+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICl9CiAgICAgICAgPGRpdiByZWY9e21lc3NhZ2VzRW5kUmVmfSAvPgogICAgICA8L21haW4+CgogICAgICB7LyogSW5wdXQgQXJlYSAqL30KICAgICAgPGZvb3RlciBjbGFzc05hbWU9InAtNCBib3JkZXItdCBib3JkZXItZ3JheS03MDAvNTAgc2hhZG93LWxnIGJnLWdyYXktODAwLzcwIGJhY2tkcm9wLWJsdXItbWQiPgogICAgICAgIDxmb3JtIG9uU3VibWl0PXtoYW5kbGVTZW5kTWVzc2FnZX0gY2xhc3NOYW1lPSJyZWxhdGl2ZSI+CiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iYWJzb2x1dGUgbGVmdC00IHRvcC0xLzIgLXRyYW5zbGF0ZS15LTEvMiI+CiAgICAgICAgICAgIDxpbnB1dAogICAgICAgICAgICAgICAgdHlwZT0iZmlsZSIKICAgICAgICAgICAgICAgIHJlZj17ZmlsZUlucHV0UmVmfQogICAgICAgICAgICAgICAgb25DaGFuZ2U9e2hhbmRsZUZpbGVDaGFuZ2V9CiAgICAgICAgICAgICAgICBjbGFzc05hbWU9ImhpZGRlbiIKICAgICAgICAgICAgICAgIGlkPSJmaWxlLXVwbG9hZCIKICAgICAgICAgICAgICAgIGFjY2VwdD0iLnBkZiwuZG9jeCwuZGN0eCIKICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPSJmaWxlLXVwbG9hZCIgY2xhc3NOYW1lPSJjdXJzb3ItcG9pbnRlciB0ZXh0LWdyYXktNDAwIGhvdmVyOnRleHQtaW5kaWdvLTQwMCB0cmFuc2l0aW9uLWNvbG9ycyI+CiAgICAgICAgICAgICAgICA8UGFwZXJjbGlwSWNvbiBjbGFzc05hbWU9ImgtNiB3LTYiIC8+CiAgICAgICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgIDx0ZXh0YXJlYQogICAgICAgICAgICB2YWx1ZT17aW5wdXR9CiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0SW5wdXQoZS50YXJnZXQudmFsdWUpfQogICAgICAgICAgICBwbGFjZWhvbGRlcj17ZmlsZU5hbWUgPyBgUXVlcnlpbmc6ICR7ZmlsZU5hbWV9YCA6ICJBc2sgYSBxdWVzdGlvbiBvciB1cGxvYWQgYSBmaWxlLi4uIn0KICAgICAgICAgICAgY2xhc3NOYW1lPSJ3LWZ1bGwgYmctZ3JheS03MDAvODAgcm91bmRlZC1sZyBwLTQgcHItMTYgcGwtMTQgc2hhZG93LWlubmVyIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1pbmRpZ28tNTAwIHRyYW5zaXRpb24tc2hhZG93IHJlc2l6ZS1ub25lIgogICAgICAgICAgICByb3dzPSIxIgogICAgICAgICAgICBzdHlsZT17eyBtaW5IZWlnaHQ6ICc1MnB4JyB9fQogICAgICAgICAgICBvbklucHV0PXsoZSkgPT4gewogICAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmhlaWdodCA9ICdhdXRvJzsKICAgICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5oZWlnaHQgPSBgJHtlLnRhcmdldC5zY3JvbGxIZWlnaHR9cHhgOwogICAgICAgICAgICB9fQogICAgICAgICAgICAgb25LZXlEb3duPXsoZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInICYmICFlLnNoaWZ0S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNlbmRNZXNzYWdlKGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9fQogICAgICAgICAgLz4KCiAgICAgICAgICB7ZmlsZU5hbWUgJiYgKAogICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iYWJzb2x1dGUgbGVmdC0xNiB0b3AtMS8yIC10cmFuc2xhdGUteS0xLzIgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgYmctZ3JheS02MDAvNTAgdGV4dC1pbmRpZ28tMzAwIHJvdW5kZWQtZnVsbCBwbC0zIHByLTIgcHktMSB0ZXh0LXNtIj4KICAgICAgICAgICAgICA8RmlsZUljb24gY2xhc3NOYW1lPSJoLTQgdy00IiAvPgogICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0idHJ1bmNhdGUgbWF4LXctZHMiPntmaWxlTmFtZX08L3NwYW4+CiAgICAgICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICAgICAgdHlwZT0iYnV0dG9uIgogICAgICAgICAgICAgICAgb25DbGljaz17cmVtb3ZlRmlsZX0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0idGV4dC1ncmF5LTQwMCBob3Zlcjp0ZXh0LXdoaXRlIgogICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgIDxYSWNvbiBjbGFzc05hbWU9ImgtNCB3LTQiIC8+CiAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgKX0KCiAgICAgICAgICA8YnV0dG9uCiAgICAgICAgICAgIHR5cGU9InN1Ym1pdCIKICAgICAgICAgICAgZGlzYWJsZWQ9e3N0YXR1cyAhPT0gJ2lkbGV9CiAgICAgICAgICAgIGNsYXNzTmFtZT0iYWJzb2x1dGUgcmlnaHQtNCB0b3AtMS8yIC10cmFuc2xhdGUteS0xLzIgcC0yIHJvdW5kZWQtZnVsbCBiZy1pbmRpZ28tNjAwIHRleHQtd2hpdGUgaG92ZXI6YmctaW5kaWdvLTUwMCBkaXNhYmxlZDpiZy1ncmF5LTYwMCBkaXNhYmxlZDpjdXJzb3Itbm90LWFsbG93ZWQgdHJhbnNpdGlvbi1jb2xvcnMiCiAgICAgICAgICA+CiAgICAgICAgICAgIDxTZW5kSWNvbiBjbGFzc05hbWU9ImgtNSB3LTUiIC8+CiAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICA8L2Zvcm0+CiAgICAgIDwvZm9vdGVyPgogICAgPC9kaXY+CiAgKTsKfTsKCmdleHBvcnQgZGVmYXVsdCBDaGF0Ow==